<UserControl x:Class="IndustrialMonitor.Views.ProcessOverview"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006" 
             xmlns:d="http://schemas.microsoft.com/expression/blend/2008" 
             mc:Ignorable="d" 
             DataContext="{Binding ProcessOverviewViewModel, Source={StaticResource Locator}}"
             d:DesignHeight="600" d:DesignWidth="800">
             
    <!-- Process Overview (Left Panel) -->
    <Border Margin="5" Style="{DynamicResource Panel}">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="35"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Process Title -->
            <Border Background="#FF1A1F2E" BorderBrush="#FF3D4559" BorderThickness="0,0,0,1">
                <TextBlock Text="PROCESS OVERVIEW - TK-101 MIXING SYSTEM" Foreground="#FF64B5F6" 
                           FontSize="12" FontWeight="Bold" VerticalAlignment="Center" Margin="15,0"/>
            </Border>

            <!-- P&ID Canvas -->
            <Canvas Grid.Row="1" Background="#FF1E2433">
                
                <!-- Inlet Pipe -->
                <Rectangle Width="130" Height="20" Fill="#FF546E7A" Stroke="#FF78909C" StrokeThickness="1" 
                           Canvas.Left="40" Canvas.Top="150"/>
                <TextBlock Text="WATER SUPPLY" Foreground="#FF90A4AE" FontSize="9" Canvas.Left="45" Canvas.Top="133"/>
                
                <!-- Inlet Valve V-101 -->
                <Border Canvas.Left="90" Canvas.Top="140" Width="55" Height="40" Background="#FF37474F" 
                        BorderBrush="#FF607D8B" BorderThickness="2" CornerRadius="2">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="V-101" Foreground="White" FontSize="11" FontWeight="Bold" HorizontalAlignment="Center"/>
                        <Border Width="40" Height="4" Background="#FF4CAF50" Margin="0,3,0,0"/>
                    </StackPanel>
                </Border>
                <TextBlock Text="INLET VALVE" Foreground="#FF81C784" FontSize="9" FontWeight="Bold" Canvas.Left="85" Canvas.Top="183"/>

                <!-- Main Tank TK-101 -->
                <Border Width="200" Height="280" Canvas.Left="170" Canvas.Top="100" 
                        Background="#FF263238" BorderBrush="#FF546E7A" BorderThickness="3" CornerRadius="3">
                    <Grid>
                        <!-- Tank Label -->
                        <TextBlock Text="TK-101" Foreground="#FFB0BEC5" FontSize="14" FontWeight="Bold" 
                                   HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,8,0,0"/>
                        <TextBlock Text="MIXING TANK" Foreground="#FF78909C" FontSize="9" 
                                   HorizontalAlignment="Center" VerticalAlignment="Top" Margin="0,26,0,0"/>
                        
                        <!-- Level Scale -->
                        <StackPanel HorizontalAlignment="Left" VerticalAlignment="Stretch" Margin="8,45,0,15" Width="25">
                            <TextBlock Text="100" Foreground="#FF78909C" FontSize="8" Margin="0,0,0,30"/>
                            <TextBlock Text="75" Foreground="#FF78909C" FontSize="8" Margin="0,0,0,30"/>
                            <TextBlock Text="50" Foreground="#FF78909C" FontSize="8" Margin="0,0,0,30"/>
                            <TextBlock Text="25" Foreground="#FF78909C" FontSize="8" Margin="0,0,0,30"/>
                            <TextBlock Text="0" Foreground="#FF78909C" FontSize="8"/>
                        </StackPanel>

                        <!-- Water Level -->
                        <Border x:Name="WaterLevelRect" Height="{Binding ScaledTankLevel}" VerticalAlignment="Bottom" 
                                Margin="35,0,8,8" Background="#FF0288D1" BorderBrush="#FF03A9F4" BorderThickness="1"/>
                        
                        <!-- Level Value Display -->
                        <Border Background="#CC000000" HorizontalAlignment="Center" VerticalAlignment="Bottom" 
                                Padding="8,4" CornerRadius="2" Margin="0,0,0,15">
                            <TextBlock Text="{Binding TankLevel, StringFormat={}{0:F1} %}" Foreground="#FF00E5FF" FontSize="18" FontWeight="Bold" FontFamily="Consolas"/>
                        </Border>
                    </Grid>
                </Border>

                <!-- Agitator Motor M-101 -->
                <Border Canvas.Left="245" Canvas.Top="55" Width="60" Height="45" Background="#FF37474F" 
                        BorderBrush="#FF607D8B" BorderThickness="2" CornerRadius="2">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="M-101" Foreground="White" FontSize="10" FontWeight="Bold" HorizontalAlignment="Center"/>
                        <TextBlock Text="MOTOR" Foreground="#FF90A4AE" FontSize="8" HorizontalAlignment="Center"/>
                    </StackPanel>
                </Border>
                <!-- Motor Status Indicator -->
                <Ellipse Width="12" Height="12" Canvas.Left="310" Canvas.Top="58" Fill="{Binding MotorStatusColor}"/>
                
                <!-- Agitator Shaft -->
                <Rectangle Width="6" Height="170" Fill="#FF78909C" Canvas.Left="272" Canvas.Top="100"/>
                
                <!-- Mixer Blades -->
                <Rectangle Width="60" Height="8" Fill="#FF90A4AE" Canvas.Left="245" Canvas.Top="260" x:Name="MixerBlade">
                    <Rectangle.RenderTransform>
                        <RotateTransform x:Name="MixerRotation" Angle="0" CenterX="30" CenterY="4"/>
                    </Rectangle.RenderTransform>
                    <Rectangle.Triggers>
                        <EventTrigger RoutedEvent="Rectangle.Loaded">
                            <BeginStoryboard>
                                <Storyboard>
                                    <DoubleAnimation Storyboard.TargetName="MixerRotation" 
                                                   Storyboard.TargetProperty="Angle" 
                                                   From="0" To="360" Duration="0:0:2" 
                                                   RepeatBehavior="Forever"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </Rectangle.Triggers>
                </Rectangle>

                <!-- Outlet Pipe -->
                <Rectangle Width="130" Height="20" Fill="#FF546E7A" Stroke="#FF78909C" StrokeThickness="1" 
                           Canvas.Left="370" Canvas.Top="340"/>
                <TextBlock Text="TO STORAGE" Foreground="#FF90A4AE" FontSize="9" Canvas.Left="420" Canvas.Top="323"/>
                
                <!-- Outlet Valve V-102 -->
                <Border Canvas.Left="400" Canvas.Top="330" Width="55" Height="40" Background="#FF37474F" 
                        BorderBrush="#FF607D8B" BorderThickness="2" CornerRadius="2">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="V-102" Foreground="White" FontSize="11" FontWeight="Bold" HorizontalAlignment="Center"/>
                        <Border Width="40" Height="4" Background="#FFEF5350" Margin="0,3,0,0"/>
                    </StackPanel>
                </Border>
                <TextBlock Text="OUTLET VALVE" Foreground="#FFEF5350" FontSize="9" FontWeight="Bold" Canvas.Left="393" Canvas.Top="373"/>

                <!-- Temperature Transmitter TT-101 -->
                <Border Canvas.Left="385" Canvas.Top="200" Width="70" Height="50" Background="#FF37474F" 
                        BorderBrush="#FFFFA726" BorderThickness="2" CornerRadius="2">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="TT-101" Foreground="#FFFFA726" FontSize="10" FontWeight="Bold" HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding Temperature, StringFormat={}{0:F1} Â°C}" Foreground="White" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" FontFamily="Consolas"/>
                    </StackPanel>
                </Border>

                <!-- Level Transmitter LT-101 -->
                <Border Canvas.Left="85" Canvas.Top="230" Width="70" Height="50" Background="#FF37474F" 
                        BorderBrush="#FF29B6F6" BorderThickness="2" CornerRadius="2">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="LT-101" Foreground="#FF29B6F6" FontSize="10" FontWeight="Bold" HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding TankLevel, StringFormat={}{0:F1} %}" Foreground="White" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" FontFamily="Consolas"/>
                    </StackPanel>
                </Border>

                <!-- Pressure Transmitter PT-101 -->
                <Border Canvas.Left="85" Canvas.Top="300" Width="70" Height="50" Background="#FF37474F" 
                        BorderBrush="#FFCE93D8" BorderThickness="2" CornerRadius="2">
                    <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                        <TextBlock Text="PT-101" Foreground="#FFCE93D8" FontSize="10" FontWeight="Bold" HorizontalAlignment="Center"/>
                        <TextBlock Text="{Binding Pressure, StringFormat={}{0:F1} bar}" Foreground="White" FontSize="12" FontWeight="Bold" HorizontalAlignment="Center" FontFamily="Consolas"/>
                    </StackPanel>
                </Border>

                <!-- Connection Lines -->
                <Line X1="155" Y1="255" X2="170" Y2="255" Stroke="#FF29B6F6" StrokeThickness="2" StrokeDashArray="2,2"/>
                <Line X1="370" Y1="225" X2="385" Y2="225" Stroke="#FFFFA726" StrokeThickness="2" StrokeDashArray="2,2"/>
                <Line X1="155" Y1="325" X2="170" Y2="325" Stroke="#FFCE93D8" StrokeThickness="2" StrokeDashArray="2,2"/>

            </Canvas>
        </Grid>
    </Border>
</UserControl>
